# gRPC 插件配置文件
# 用于注册外部 gRPC 节点插件
#
# 使用方法：
# 1. 启动你的 gRPC 插件服务
# 2. 在此文件中配置插件信息
# 3. 重启 gflow 服务或调用 API 重新加载配置

plugins:
  # Echo 插件 - 用于测试
  - name: "Echo Plugin"
    kind: "echo_plugin"
    endpoint: "localhost:50051"
    enabled: true
    health_check: true
    description: "回显插件 - 用于测试"
    version: "1.0.0"
    category: "action"
    icon: "MessageCircle"
    color: "blue"

  # Python 测试插件
  - name: "Test Python Plugin"
    kind: "test_py_plugin"
    endpoint: "localhost:50051"
    enabled: true
    health_check: true
    description: "Python 测试插件"
    version: "1.0.0"
    category: "plugin"
    icon: "Plug"
    color: "green"

  # 通用测试插件
  - name: "Test Plugin"
    kind: "test_plugin"
    endpoint: "localhost:50051"
    enabled: true
    health_check: true
    description: "测试插件"
    version: "1.0.0"
    category: "plugin"
    icon: "Plug"
    color: "green"

  # Timer Trigger 插件（Go 实现的定时触发器）
  - name: "Timer Trigger"
    kind: "timer_trigger"
    endpoint: "localhost:50052"
    enabled: true
    health_check: true
    description: "定时触发插件：按 filters.interval_ms 推送触发事件"
    version: "1.0.0"
    category: "trigger"
    icon: "Timer"
    color: "green"
    consumer_group: "default"
    filters:
      interval_ms: 1500   # 每 1.5 秒一个事件
      count: 10           # 推送 10 次后结束（为 0 则无限）
  - name: "db_operator"
    kind: "db_operator"
    endpoint: "localhost:50054"
    enabled: true
    health_check: true
    description: "数据库操作插件"
    version: "1.0.0"
    category: "plugin"
    icon: "Plug"
    color: "green"

  # HTTP Gateway 插件
  - name: "HTTP Gateway"
    kind: "http_gateway"
    endpoint: "localhost:50053"
    enabled: true
    health_check: true
    description: "HTTP 网关插件：监听指定端口和路由，推送触发事件"
    version: "1.0.0"
    category: "trigger"
    icon: "Globe"
    color: "purple"
    consumer_group: "default"
    filters:
      http_port: 8080
      # 方案一：精确绑定路由到唯一工作流，并开启同步响应
      routes:
        - path: "/api/v1/orders"
          methods: ["POST"]
          target_workflow: "HTTP Gateway Trigger Demo"
          sync_response: true
          response_timeout_ms: 30000
        - path: "/api/v1/status"
          methods: ["GET"]
          target_workflow: "Response Node Test Workflow"
        - path: "/api/v1/db"
          methods: ["GET"]
          target_workflow: "SQLite DB Operator Workflow"
          sync_response: true
          response_timeout_ms: 30000
          
  # 可以添加更多插件
  # - name: "Custom Plugin"
  #   kind: "custom_node"
  #   endpoint: "remote-server:50053"
  #   enabled: true
  #   health_check: true
  #   description: "自定义插件"
  #   category: "action"
  #   tls:
  #     enabled: true
  #     cert_path: "/path/to/cert.pem"
  #     key_path: "/path/to/key.pem"
